# VPC
- 従来のデータセンターのようなネットワークを構成する
- VPCをセキュアにするのはセキュリティグループとネットワークACL
  - NACLはステートレス
  - SGはステートフル
- VPC内の通信は課金されない
- 作成されたリソースはARNがつく
- VPCには複数のAZが存在する
- サブネットは一つのAZに所属する
  - デフォルトではお互いにルーティングされる
- 複数サービスを組み合わせた場合のサブネットの数の計算
- VPC同士を広帯域で接続するのはピア接続

# EC2
- EC2とはクラウド上の仮想サーバ
- EC2はAMIから作成する
  - AMIの種類(EBSベース、S3ベース)
- ec2 APIを使用して作成も可能
- インスタンスのロケーションはAZに紐づく
- インスタンスやイメージ、リソース管理にはタグが便利
- 少なくとも一つのセキュリティグループを紐づける必要がある
- セキュリティグループは、インスタンス作成後も変更できる
- シングルテナントにする方法
- 公開されたデータセットを使用するには無料。
- ECUとは？
- SOAPを利用してできること
- ユーザーデータ
  - 起動時にスクリプトなど指定した処理を行うことができる
- Metadata
  - クエリベースのインスタンス情報
- 無料で利用できる範囲のインスタンスタイプの種類の確認
  - HVMや準仮想、EBSやインスタンスストア
- EC2がサポートするブロックデバイス(EBSとインスタンスストアボリューム)
  - ブロックデバイストは(ランダムアクセスとバッファ利用ができるデバイス)
  - インスタンスストアボリューム
    - インスタンスが終了したとき、データは自動的に削除される
  - EBS
    - インスタンスは停止と起動ができる(データは保持される。インスタンスのライフサイクルとは独立になる)
    - EBSのインスタンスでも、停止するとエフェメラルボリュームは初期化される
    - EBSは暗号化できるが、タイミングに制限がある(スナップショットのコピー時など)
    - 暗号化するにはサードパーティのツールや、ファイルシステムを暗号化、保持するデータを暗号化する
    - 暗号化したEBSのスナップショットは暗号化される
    - 複数のインスタンスに同時にアタッチできない
    - 作りなしたいときは、スナップショットを取り作り直す
    - EBSのみ使用できるインスタンスタイプもある
    - スナップショットは非同期で作成。増分のみS3に保存する
    - スナップショット作成中のステータス(pending)
    - スナップショットにアクセスできるのはec2 api
    - 一貫性のあるスナップショットを取るには、インスタンスを停止してから取る
- インスタンス作成時のデバイスの扱い
  - /dev/sda1はルートデバイスが予約している
  - (CLI使用時)インスタンス作成時に/dev/sdc=noneとすると、/dev/sdcにアタッチしない
- ProvisionIOPS
  - 最低10GB必要
- ネットワーク関連
  - IPが二つ付与される。プライベートIPとパブリックIP
  - プライベートIPで通信する場合、VPCを使う
  - EIPにコストがかかるタイミング
  - インスタンスでパブリックIP使って通信する場合はEIPを設定すべき
  - ENIはインスタンスを作成すると作成され、終了すると削除される
  - Eth0のENIはインスタンスが停止/起動かかわらずデタッチできない
  - NATインスタンスを作成する場合、「送信元/送信先チェック」を無効にする
  - sshでインスタンスに接続するために必要な設定
    - NACL、セキュリティグループ、秘密鍵、ユーザ名
- リザーブドインスタンス(RI)
  - リージョンを移動できない
  - AZはまたげる
  - 価格が安い
- スポットインスタンス
  - AWSでも余剰リソースを安く提供
  - 価格はスポット < RI < On-demand
- プレイスメントグループ
  - インスタンスを広帯域、低レイテンシで接続する
- オートスケール
  - ELBと組み合わせて負荷分散
  - グループ内のインスタンスが終了すると、ルールに従いインスタンス数を保つ
  - インスタンスが終了するとSNSに通知する
  - 起動設定で設定できること。ASGで設定できること

# ELB
- アクセスログを有効にできる
- マルチAZを有効にする機能はcross-zone load balancing
- マルチAZで高可用性を実現できるサービスはELBとEC2
- ヘルスチェックが失敗すると外套のインスタンスにトラフィックを送らなくなる
- ELBに外部から接続するにはパブリックサブネットに配置し、セキュリティグループとACLの設定を適切にする

# セキュリティグループ
- セキュリティグループはインスタンスのファイアウォール
- NACLはサブネットのセキュリティ
- 同じセキュリティグループを設定しているインスタンスは、セキュリティグループの内容を変更すると即座にすべて反映する
- インスタンス作成後にも、所属するSGを変更できる
- APIで操作可能
- インスタンスへ外部から接続する場合のSGの設定方法
  - 例)グルーバルIPでsshでインスタンスに接続する場合、インバウンドはSource XXX TCP Port 22

# Route53
- Route53が提供するのはDNS
- AレコードとAliasとCNAMEの違い
  - ELBをドメインのzone apexと紐づける方法
- Route53のルーティングポリシーの使い分け
  - 地理的なルーティング、レイテンシベースのルーティングなど

# IAM
- IAMを使わない場合、複数AWSアカウントを作成するか、複数の社員が単一のアカウントを共有するしかない
- 自アカウントのリソースに対して別アカウントにも権限を与えることができる
- IAMはリージョンに依存しない
- SAMLを利用するとLDAPと統合できる
- AWSの権限はユーザベースとロールベース
- ユーザ
  - どのユーザもはじめは権限なし
  - サードパーティのソフトを使いたい場合はユーザに権限を付与する
  - ユーザ作成後、APIをっ使う場合アクセスキーを作成する
- グループ
  - グループは複数のユーザを含む、ユーザは複数のグループに所属できる
- ロール
  - インスタンスに設定したロールを変えるには、イメージを作成してインスタンスを作り変える必要があった。現在は作り直さずに変更可能
  - アクセスキーを使用せず権限を与えられる

# S3
- S3の特徴
  - データ量の制限なし
  - オブジェクトはURLでアクセスできる
- 冗長性
  - 同じリージョン内で複数個所に保存
- S3へのアクセス制御
  - オブジェクトACL、バケットポリシー、IAM
  - デフォルトではパーミッション設定なし
  - 署名付きURLの利用
- 暗号化の方法
  - サーバサイド、クライアントサイド
  - どのタイミングで暗号化されるか
- 一貫性
  - PUT/DELETEは完全にオブジェクトへの処理が完了してから成功ステータスを返す
  - 成功ステータスは200PUTではMD5の結果も変える
- 静的今テンスのストレージとしてCPUリソースが低い
- 保存時、key nameのprefixをランダムにすると高パフォーマンス
- バケットのアクセスログを有効にすると監査に利用できる
- 誤操作による削除を防ぐため、バケットのバージョニングと多要素認証が有効
- 大容量のファイルを保存するときはマルチアップロードを使うと高速
- アップロードに失敗するとresumeする
- RRS:Reduced Redundancy Storage
  - 冗長性を減らしたため低価格
  - 耐久性は99.99%
- Glacierの特徴
  - 低価格のストレージ
  - 冗長性
  - セキュア
- Glacier MultiPart Upload
  - 高速アップロード
- StorageGatewayについて
  - オンプレミスからクラウドのストレージへのアクセスを提供する
  - 利用方法について要確認

# RDS
- アップグレード
  - 新しいバージョンにアップグレードする前に新しいバージョンのテストが可能
- インスタンス作成時にはセキュリティグループを設定する。内容は操作できない
- RDSはssh、RDP、telnetなどOSの権限が必要なことはできない
- HTTPS経由のSOAPが利用できる
- イベント発生時にアラートをSNSに送信できる
- サポートするエンジンはMySQL、Oracle、SQLServer、PostgreSQL、Aurora、MariaDB
- DBインスタンスがIdle中でも課金される
- スナップショット
  - 保存先はS3
  - 手動でスナップショットを作成した場合、インスタンスを削除してもスナップショットは消えない
  - 自動バックアップは新しいインスタンスではデフォルトで有効
  - 自動バックアップはinnodbのみ
  - 自動バックアップを無効にすると、時間指定のリストアも無効になる
- Multi-AZ、レプリケーション
  - 高可用性を実現
  - スタンバイインスタンスはプライマリインスタンスと同じリージョンの別のAZに作成される
  - フェイルオーバーはCNAMEが回変わる
  - SNSを設定するとフェイルオーバー時に通知が可能
  - レプリケーションデータの通信は無料
- リードレプリカ
  - サポートするのはinnodb
  - プライマリが読み書き、レプリカが読み取りを提供
  - リードレプリカのリードレプリカはできない
    - MySQLのみ可能
- MySQL
  - Multi-AZで強制フェイルオーバーが可能
  - X.Y.ZのXはメジャーバージョン
- Oracle
  - 所有しているOracleのライセンスを使用するおモデルをBYOLという
  - インスタンスタイプによっては限られたバージョンしか選べない
  - Multi-AZの強制フェイルおーばが可能
  - DatabaseDiagnosticPackとDatabaseTuningPackはEnterpriseEditionのみ有効

# CloudWatch
- 最小のインターバルは詳細モニタリングの1分
- 無料の範囲(Basic)でメトリックを使用すると5分のインターバル
- PIOPSとEBSはデフォルトで1分
- OSの中の情報はカスタムメトリックを作成する
  - メモリ使用量など
- RDSのPIOPSを監視してアラートを上げたい場合、ClouWatchとSNSを組み合わせる

# DirectConnect
- データセンターから専用線でプライベート回線を引くサービス
- リージョン内のすべてオンAZへのアクセスを可能にする
- ユーザ側の回線のインターフェイスはPrivateVirtualInterface

# その他
- プレミアムサポートのレスポンスタイムは1時間以内
- ElasticBeanstalkはコンテナサービス
  - EC2の管理者権限が必要
- ElasticMapReducceはビッグデータフレームワーク
  - EC2の管理者権限が必要
- SESはメッセージサービス。何の略か
- DynamoDBの書き込みスループットの上限はなく、高可用性、低レイテンシー。
  - WebセッションやJSONドキュメント、S3のmetadataの保存などに使う。
- CloudFormationはテンプレートによるリソース作成を提供する
- Security Token Service(STS)は一時的な認証情報を提供する
- SimpleWorkFlowは作業コーディネートサービス。
  - どんな時に使うか
  - ドメインについて
- Kinesisはどんな時に使うか
- SQS
  - どんな時に使うか
  - 水平スケールが容易
- Direct Service AD Connector
  - どんな時
- SNSが利用できる通知サービス
  - EmailやSMS
- CloudTrailについて
  - Puppet/Chefを利用してアプリケーションを設定、運用する
- WorkSpaceについて
  - WindowsベースのDaaSサービス























