# 学習記録

## SAA #001~#003

### インスタンスがインターネットに接続するためのステップ
1. サブネット作成
2. インターネットGWをアタッチ
3. カスタムルートテーブルを作成
4. セキュリティグループルールを変更
5. EIPを追加

### 他のユーザのELBは設定変更可能

### Storage Gateway
StorageGatewayを使うと、バックアップ製品と親和性が高いiSCSIテープデバイスとして扱えるので、保存先であるiSCSIイニシエータの宛先を変更するだけでAWSへのデータバックアップが可能になる。

### アイデンティティおよびリソースベースのポリシー
アクセス許可ポリシーを作成してリソースへのアクセスを制限する場合、アイデンティティベースのポリシーまたはリソースベースのポリシーを選択可能。

- アイデンティティベースのポリシー
IAMユーザ、グループ、ロールにアタッチ。そのアイデンティティが実行できる内容(アクセス許可)を指定する。

- リソースベースのポリシー
各リソースにアタッチする。例えば、S3バケット、SQSキューなど。

### リザーブドDBインスタンスの利点
マルチAZ、シングルAZの両設定に適用される。

### RDSの性能向上
||可用性|スループット増|レイテンシ|
|---|---|---|---|
|スケールアップ|-|●|-|
|Multi AZ|●|-|-|
|リードレプリカ|-|●|-|
|プロビジョンドIOPS|-|●|●|

### EC2インスタンスを別リージョンに移行する
インスタンスを停止し、AMIを作成し別リージョンへコピーする

### プロビジョンドIOSPの料金体系
プロビジョニングした容量(Gb/月)で決まり、そのストレージを解放するまで毎月料金が発生する。

## SAA #004

### RDSのマルチAZ配置
マルチAZDBインスタンスをプロビジョニングすると、プライマリDBインスタンスを自動的に作成すると同時に、異なるAZにあるスタンバイインスタンスにデータを複製する。

### EBSのボリュームステータス
ボリュームステータスチェックは5分ごとに自動的に施行され、成功または失敗のステータスを返す。

|ステータス||
|---|---|
|ok|すべてのチェックが成功した場合|
|impaired|失敗した場合|
|insufficient-data|実行中の場合|
|warning|パフォーマンスが下回っている|

### インスタンスの削除保護の有効化
起動時にインスタンスに対する削除保護を有効にするには、[Enalbe termiation protection]チェックボックスをオン
> 実行中・停止中でも削除保護は有効にできる。その場合は、[Action]から[Change Termination Protection]をクリック。

### クラスタープレイスメントグループ
クラスタープレイスメントグループは、単一のAZ内のインスタンスを論理的にグループ化したもの。主な利点は、10Gbpsのフロー制御に加え、非ブロッキング、非オーバーサブスクライブの完全に2分割されている接続であること。つまり、インスタンス間のネットワークレイテンシーを低く抑えることができる。

### DBインスタンスの最終スナップショット
DBインスタンスの削除時、デフォルトでRDSDBインスタンスを削除した場合、`自動バックアップと手動スナップショットは保持`される。

## SAA#005
### オンプレからAWSへの移行についての総合問題
#### インポートの可否
VMware ESXおよびMicrosoft Hyper-Vの仮想マシンイメージをAWS状にインポートするには、【VM Import/Export】を利用する。

#### 対応バージョン
32bit全般と、RHEL6.0は未対応(サポートなし)。

#### VMImportで対応しているインスタンスタイプ
一部のインスタンスタイプのみ対応。
- t2、m3、c3、cc2、cr1、hi1、hs1、i2、cg1

#### GPTについて
- Windows
GPTパーティション分割ボリュームではイメージ形式としてVHDXのみサポートされている。

- Linux/Unix
GPTでパーティション分割されたボリュームはサポートされていない。

#### インポート時の注意(ログオン)
Windows側でリモートデスクトップによるリモート管理を有効にしていないと、EC2インスタンスにログオンできない。
また、WindowsFirewallでRDP(TCP:3389)のポートをブロックしないように設定する。
AWS側はセキュリティグループでTCP:3389を空ける必要もある

#### インポート時の注意(インポート失敗)
VMImportはインポート中に自動的にEC2Config Serviceをインストールするため、事前に.NET Framework 3.5 SP1をインストールしておく必要がある。

#### インポート時の注意(Windowsのアクティベーション失敗)
インポート完了後に時刻設定がずれることが原因でWindowsアクティベーションに失敗することがある。
タイムゾーンをUTCに設定し、NTPサーバと時刻同期を行う。

#### いポート時の注意(IPアドレス)
インポート後、EC2インスタンスはIPアドレスを取得できないため、インポートに失敗する。
DHCPを有効にしてインポートすることで、EC2インスタンスがIPアドレスを取得できるようになる。

## SAA#006
### NATインスタンス
EC2インスタンスは送受信する任意のトラフィックの送信元、または送信先である必要がある(送信元/送信先チェック)。しかしNATインスタンスは送信元/先が自身でない場合にもトラフィックを送受信できなければならない。よって送信元/送信先チェック(SrcDestCheck属性)を無効にする必要がある。

### プレイスメントグループ
- クラスタープレイスメントグループ
2つのインスタンスを単一のAZにないの低レイテンシーグループにクラスタ化する

- スプレッドプレイスメントグループ
基盤となるハードウェアにインスタンスを分散する。

### インスタンスメタデータ
インスタンスのプロパティは「インスタンスのメタデータ」より確認することが可能。
実行中のインスタンス内からすべてのカテゴリをひょじするには、`http://169.254.169.254/latest/meta-data/`を使用する。

### Amazon S3の特徴
S3は1年でオブジェクトの99.999999999%の`耐久性`と99.99%の`可用性`を提供する。
オブジェクトの最大サイズは`5TB`。

## SAA#007
### 一般的なDB処理
- OLTP(Online Transaction Processing)
主に受注発注処理や販売・生産管理などの業務システムにおける操作ニーズに対応したもの。

- OLAP(Online Analytical Processing)
大量データの集計や分析を目的とするもので、ユーザは限定的だが、大量レコードの一括書き込みなどの複雑な処理が発生する。

> OLTP系はランダムアクセス、OLAP系はシーケンシャルアクセスを主体

### VPN接続の設定
ルーティング可能な静的なIPアドレスをAmazon仮想プライベートクラウド(VPC)にリンクするカスタマーゲートウェイに割り当てる。
カスタマーゲートウェイの外部インターフェースで、ルーティング可能なIPアドレスは静的である必要がある。

### Route 53の対応プロトコル
HTTP, HTTPS, TCPのみ

### Amazon S3のデータ整合性モデル
- 新規ファイルをアップロード時は、「書き込み後の読み込み」整合性
- 既存ファイルの上書き・削除時は、古いデータを参照または削除ファイルを参照できる状態となり、結果整合性

## SAA#008
### Amazon ElastiCacheのインメモリエンジン
完全マネージド型のRedisおよびMemcachedを利用可能。

### EC2インスタンス削除時にEBSを保持する
デフォルトでは、インスタンスの削除時にEBSのルートデバイスボリュームが自動的に削除されます。ただし、アタッチしたEBSがある場合、デフォルトではそれらのボリュームは保持される。この動作はボリュームのDeleteOnTerminationの値によって決まる。
- DeleteOnTermination True: インスタンス削除時にEBSを削除する
- DeleteOnTermination False: インスタンス削除時にEBSを削除しない

### RDSのスタンバイレプリカ
RDSのマルチAZ配置のスタンバイレプリカを使用して、読み取りトラフィックを処理することはできない。
読み取り専用トラフィックを処理するには、リードレプリカを使用する。
||可用性|スループット増|レイテンシ|
|---|---|---|---|
|スケールアップ|-|●|-|
|Multi AZ|●|-|-|
|リードレプリカ|-|●|-|
|プロビジョンドIOPS|-|●|●|

## SAA#009
### EBSでRAIDを作成
- RAID0: I/Oパフォーマンスが耐障害性よりも重要な場合に使用する
- RAID1: I/Oパフォーマンスよりも耐障害性が重要な場合に使用する
- RAID5と6: IOPSの一部がパリティ書き込みによって消費されるため推奨されない

### EBSの特徴
EBSは、データに素早くアクセスする必要があり、長期永続性が必要な場合に推奨される。ファイルシステムの主要ストレージやデータベースとしての使用に特に適している。また、更新頻度が高いアプリケーションにも適している。  
プロビジョンドIOPS SSD (io1)を用いることで、`ランダムな読み取り/書き込みに依存する‘データベーススタイルのアプリケーション`と、`長時間の連続読み取り/書き込みを実行するスループットが高いアプリケーション`の両方に適している。

## SAA#010
### RDSにおけるストレージエンジン
MySQLのRDSにおける特定時点の復元およびスナップショット復元機能には、クラッシュからの回復可能なストレージエンジンが必要で、`InnoDB`のみがサポートされている。

### ElasticIPの課金体系
停止中のインスタンスにElasticIPが関連付けられた場合、課金される。

### プレイスメントグループの削除
プレイスメントグループを削除する場合、`起動したすべてのインスタンスを削除する`か、`別のプレイスメントグループに移動する`必要がある。

### Amaon DynamoDBの特徴
1桁のミリ秒のレイテンシを必要とするアプリケーション向けの高速なNoSQLデータベース。
- Webセッション情報
- JSONドキュメント
- オブジェクトのメタデータの保存
に適している。

### インスタンス起動時のコマンド実行
インスタンスを起動するとき、起動後にユーザデータを渡し、自動設定タスクを実行したりスクリプトを実行したりできる。

## SAA#011
### S3の年間ダウンタイム
|可用性|ダウンタイム|
|---|---|
|99.99%|52分|
|99.999%|5分|
|99.9999%|3秒|
|99.999999999%|0.3ミリ秒|

## SAA#012
### マルチパートアップロード
アップロード中に中断された場合、パートのアップロードを再試行するだけでOK。

### インスタンスのメタデータとユーザデータ
メタデータおよびユーザデータはインスタンス自体内からのみアクセスできるものの、`データは暗号化手法によって保護されていない`。


### Amazon Aurora
Auroraはスケーラビリティを提供。64TiBまで成長し、100ミリ秒未満のレプリカラグを提供する。

Auroraには高性能のストレージサブシステムが含まれている。基本ストレージは、必要に応じて最大64TiBまで`自動的に`拡張される。データベースのクラスター化とレプリケーションも自動化及び標準化する。

### Amazon RDS for PostgreSQLのDBインスタンス削除時
すべてのリードレプリカがスタンドアロンDBインスタンスに昇格され、読み込みトラフィックと書き込みトラフィックの両方を受け付ける。

### CloudWatch アラームでできること
- メールを送信する
- SQSキューに発行する
- EC2インスタンスを停止または削除させる
- AutoScalingポリシーを実行する
- SNSでサポートされている通知タイプ

### CloudFormation
AWS CloudFormationを使用する際は、テンプレートとスタックの作業を行う。
- テンプレート
AWSリソースとそのプロパティを記述するために作成する。

- スタック
スタックを作成するたびにAWS CloudFormationはテンプレートに記述されているリソースをプロビジョニングする。

## SAA#013
### Amazon Elastic Beanstalk
Elastic Beanstalkはアプリケーションをデプロイするための最速で簡単な方法。

### Amazon Simple Workflow(SWF)
SWFはタスクを組み合わせてワークフローを作成できる。以下のような処理をワークフローで処理可能。
1. スマホの画像をS3へアップロード
2. リサイズ
3. メールでメンバーへ送信

### Route53でサポートされるDNSレコードタイプ
※抜粋
- A(アドレスレコード)
- AAAA(IPv6アドレスレコード)
- CNAME(正規名レコード)
- MX(メール交換レコード)
- NS(ネームサーバレコード)
- PTR(ポインターレコード)
- SOA(管理情報の始点レコード)
- SPF(センダーポリシーフレームワーク)
- SRV(サービスロケーター)
- TXT(テキストレコード)


---
## SAA#079
### セキュリティグループの基本
- セキュリティグループを作成するときにはインバウンドルールはない。
- デフォルトでは、すべてのアウトバウンドトラフィックを許可するルールが含まれている。

### ダウンタイムの最小化：自動フェイルオーバーでのマルチAZ
ダウンタイムを最小限に抑えるには、マルチAZとクラスターによる自動フェイルオーバーを有効にする。この場合、プライマリノードは、いずれかのリードレプリカにフェイルオーバーされる。

### Amazon S3 ストレージクラス(Glacier)
セキュアで耐久性が高く、低コストのストレージクラスでデータのアーカイブに適している。取り出しオプションには数分から数時間まで3種類を用意している。
- 高速取得：1~5分
- 標準取得：3時間から5時間
- バルク取得：5時間から12時間以内(※最もコストが低い)

### Instance Store-Backed AMIの作成プロセス
1. 新しいAMIを使用してインスタンスを起動すると、S3にアップロードしたバンドルを使用してインスタンスのルートボリュームを作成する。
2. S3のバンドルで使用されるストレージ領域については、その領域を削除するまでアカウントに料金が発生する。
3. ルートデバイスボリュームに加えて、インスタンスストアボリュームをインスタンスに追加した場合、新しいAMIのブロックデバイスマッピングにこれらのボリューム情報が含まれ、新しいAMIから起動するインスタンスのブロックデバイスマッピングに自動的にこれらのボリュームの情報が含まれる。

### EC2インスタンスにアタッチされているIAMロールの更新
インスタンスが実行中でも割り当ては可能。

### Application Load Balancerのアクセスログ
ElasticLoadBalancingは、ロードバランサーに送信されるリクエストについて、詳細情報を取得するアクセスログを提供します。このアクセスログを使用して、トラフィックパターンの分析や、トラブルシューティングを行う。デフォルトでは無効にされている。取得したログは圧縮ファイルとして指定したS3バケット内に保存される。

---
## 進捗
* [X] ~~*SAA#001*~~ [2020-09-29]
* [X] ~~*SAA#002*~~ [2020-09-29]
* [X] ~~*SAA#003*~~ [2020-09-29]
* [ ] AWS理解度確認テストPart1
* [X] ~~*SAA#004*~~ [2020-09-29]
* [X] ~~*SAA#005*~~ [2020-09-29]
* [X] ~~*SAA#006*~~ [2020-09-29]
* [X] ~~*SAA#007*~~ [2020-09-29]
* [X] ~~*SAA#008*~~ [2020-09-29]
* [X] ~~*SAA#009*~~ [2020-09-30]
* [X] ~~*SAA#010*~~ [2020-09-30]
* [X] ~~*SAA#011*~~ [2020-09-30]
* [X] ~~*SAA#012*~~ [2020-09-30]
* [X] ~~*SAA#013*~~ [2020-09-30]
* [ ] SAA#014
* [ ] SAA#015
* [ ] SAA#016
* [ ] SAA#017
* [ ] SAA#018
* [ ] SAA#019
* [ ] SAA#020
* [ ] SAA#021
* [ ] SAA#022
* [ ] SAA#023
* [ ] SAA#024
* [ ] SAA#025
* [ ] SAA#026
* [ ] SAA#027
* [ ] SAA#028
* [ ] SAA#029
* [ ] SAA#030
* [ ] SAA#031
* [ ] SAA#032
* [ ] SAA#033
* [ ] SAA#034
* [ ] SAA#035
* [ ] SAA#036
* [ ] SAA#037
* [ ] SAA#038
* [ ] SAA#039
* [ ] SAA#040
* [ ] SAA#041
* [ ] SAA#042
* [ ] SAA#043
* [ ] SAA#044
* [ ] SAA#045
* [ ] SAA#046
* [ ] SAA#047
* [ ] SAA#048
* [ ] SAA#049
* [ ] SAA#050
* [ ] SAA#051
* [ ] SAA#052
* [ ] SAA#053
* [ ] SAA#054
* [ ] SAA#055
* [ ] SAA#056
* [ ] SAA#057
* [ ] SAA#058
* [ ] SAA#059
* [ ] SAA#060
* [ ] SAA#061
* [ ] SAA#062
* [ ] SAA#063
* [ ] SAA#064
* [ ] SAA#065
* [ ] SAA#066
* [ ] SAA#067
* [ ] SAA#068
* [ ] SAA#069
* [ ] SAA#070
* [ ] SAA#071
* [ ] SAA#072
* [ ] SAA#073
* [ ] SAA#074
* [ ] SAA#075
* [ ] SAA#076
* [ ] SAA#077
* [ ] SAA#078
* [ ] SAA#079
* [ ] SAA#080
* [ ] SAA#081
* [ ] SAA#082
* [ ] SAA#083
* [ ] SAA#084
* [ ] SAA#085
* [ ] SAA#086
* [ ] SAA#087
* [ ] SAA#088
* [ ] SAA#089
* [ ] SAA#090
* [ ] SAA#091
* [ ] SAA#092
* [ ] SAA#093
* [ ] SAA#094
* [ ] SAA#095
* [ ] SAA#096
* [ ] SAA#097
* [ ] SAA#098
* [ ] SAA#099
* [ ] SAA#100
* [ ] SAA#101
* [ ] SAA#102
* [ ] SAA#103
* [ ] SAA#104
* [ ] SAA#105
* [ ] SAA#106
* [ ] SAA#107
* [ ] SAA#108
* [ ] SAA#109
* [ ] SAA#110
* [ ] SAA#111
* [ ] SAA#112
* [ ] SAA#113
* [ ] SAA#114
* [ ] SAA#115
* [ ] SAA#116
* [ ] SAA#117
* [ ] SAA#118
* [ ] SAA#119
* [ ] SAA#120
* [ ] SAA#121
* [ ] SAA#122
* [ ] SAA#123
* [ ] SAA#124
* [ ] SAA#125
* [ ] SAA#126
* [ ] SAA#127
* [ ] SAA#128
* [ ] SAA#129
* [ ] SAA#130
* [ ] SAA#131
* [ ] SAA#132
* [ ] SAA#133
* [ ] SAA#134
* [ ] SAA#135
* [ ] SAA#136
